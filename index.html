<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>è‡´é˜¿ä½³å®å®</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=ZCOOL+KuaiLe&display=swap" rel="stylesheet">

    <style>
        /* --- æ ·å¼éƒ¨åˆ†ä¿æŒä¸å˜ --- */
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background: linear-gradient(to bottom, #ffdee9 0%, #b5fffc 100%); font-family: 'ZCOOL KuaiLe', cursive; }
        #canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; pointer-events: none; }
        .container { position: absolute; top: 45%; left: 50%; transform: translate(-50%, -50%); z-index: 10; text-align: center; width: 100%; user-select: none; -webkit-tap-highlight-color: transparent; }
        h1 { color: #ff5e78; font-size: 3.5rem; line-height: 1.4; margin: 0; text-shadow: 2px 2px 0px #fff, 4px 4px 10px rgba(255, 94, 120, 0.3); cursor: pointer; transition: transform 0.1s; }
        h2 { color: #ff99ac; font-size: 2rem; margin-top: 10px; font-weight: normal; }
        .lyric-box { margin-top: 30px; height: 40px; color: #446699; font-size: 1.3rem; text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.8); transition: opacity 0.3s; opacity: 1; font-weight: bold; }
        .music-btn { position: fixed; top: 20px; right: 20px; z-index: 999; width: 40px; height: 40px; background: rgba(255, 255, 255, 0.6); border-radius: 50%; border: 2px solid #ff5e78; display: flex; align-items: center; justify-content: center; cursor: pointer; box-shadow: 0 0 10px rgba(255, 94, 120, 0.3); }
        .rotate { animation: spin 3s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .music-icon { width: 20px; height: 20px; fill: #ff5e78; }
        .jelly { animation: jelly 0.6s; }
        @keyframes jelly { 0%, 100% { transform: scale(1, 1); } 25% { transform: scale(0.9, 1.1); } 50% { transform: scale(1.1, 0.9); } 75% { transform: scale(0.95, 1.05); } }
        @media (max-width: 768px) { h1 { font-size: 2.8rem; } h2 { font-size: 1.5rem; } .lyric-box { font-size: 1.1rem; } }
        .hint { position: absolute; bottom: 20px; width: 100%; text-align: center; color: #aaa; font-size: 0.8rem; z-index: 5; opacity: 0.7; }
    </style>
</head>
<body>

    <audio id="bgm" loop>
        <source src="love.mp3" type="audio/mpeg">
    </audio>

    <div class="music-btn rotate" id="musicBtn" onclick="toggleMusic()">
        <svg class="music-icon" viewBox="0 0 24 24">
            <path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"/>
        </svg>
    </div>

    <canvas id="canvas"></canvas>

    <div class="container">
        <h1 id="main-text" onclick="bounce(this)">é˜¿ä½³å®å®</h1>
        <h2 onclick="bounce(this)">æˆ‘çˆ±ä½ </h2>
        <div class="lyric-box" id="lyric-display"></div>
    </div>

    <div class="hint">ç‚¹å‡»å±å¹•å¼€å¯æƒŠå–œ</div>

    <script>
        // ==========================================
        //  ğŸ‘‡ è¯·æŠŠä½ çš„ LRC æ–‡ä»¶å†…å®¹ç²˜è´´åˆ°ä¸‹é¢ä¸¤ä¸ªåå¼•å·ä¸­é—´
        // ==========================================
        const lrcFileContent = `
[00:00.0]æ‹çˆ±ç”»æ¿ - é”¦é›¶
[00:00.13]è¯ï¼šæå¸ˆç
[00:00.2]æ›²ï¼šæå¸ˆç
[00:00.28]ç¼–æ›²ï¼šæå¸ˆç
[00:00.38]éŸ³ä¹åˆ¶ä½œäººï¼šå¼ åšæ–‡Bryan Z
[00:00.57]å‰ä»–ï¼šé½æˆåˆš
[00:00.66]å’ŒéŸ³ç¼–å†™ï¼šé‡‘é’Š
[00:00.77]å’ŒéŸ³ï¼šç‹è¶…
[00:00.85]æ··éŸ³/æ¯å¸¦å·¥ç¨‹ï¼šææ™¨æ›¦
[00:01.04]å½•éŸ³å¸ˆï¼šä¸æœ‰é’±
[00:01.15]å½•éŸ³æ£šï¼šKGéŸ³ä¹å·¥å‚
[00:01.31]æ··éŸ³/æ¯å¸¦å·¥ä½œå®¤ï¼šBryan Z Music Studio
[00:01.53]åˆ¶ä½œåŠ©ç†ï¼šå®‹å­æ¥š/åˆ˜å“²/è¢æ°¸è¾¾
[00:01.8]ç›‘åˆ¶ï¼šå¼ åšæ–‡Bryan Z
[00:01.93]éŸ³ä¹åˆ¶ä½œï¼šåæ˜‡éŸ³ä¹ï¼ˆå¤©æ´¥ï¼‰æœ‰é™å…¬å¸
[00:02.2]å°é¢è®¾è®¡ï¼šZisswn
[00:02.29]éŸ³ä¹é¡¹ç›®æ€»ç›‘ï¼šå®«å°¹ç³Rainie
[00:02.48]æ€»ä¼åˆ’ï¼šé©¬è¶Š/é™ˆé’°å½¬
[00:02.66]ä¼åˆ’è¥é”€ï¼šHot Cake Studio
[00:02.79]OPï¼šå¤©æ´¥åæ˜‡é›†å›¢æœ‰é™å…¬å¸
[00:03.0]SPï¼šHot Cake Studio
[00:03.07]å‡ºå“ï¼šHot Cake Studio
[00:03.17]ã€Œæœªç»è®¸å¯ ä¸å¾—ç¿»å”±ç¿»å½•æˆ–ä½¿ç”¨ã€
[00:03.46]çˆ±æƒ…æœ‰ç´«è‰²çº¢è‰²è“è‰²ç™½è‰²å››ç§é¢œè‰²
[00:09.05]ç»˜ç”»å‡ºæ‹çˆ±ä¸­ç»šçƒ‚çš„ä¸–ç•Œ
[00:27.11]å¼€å§‹çš„æ—¶å€™
[00:29.86]ç‰µä½ çš„æ‰‹éƒ½ä¼šé¢¤æŠ–
[00:33.52]æˆ‘æŠŠè¿™ç§æ„Ÿè§‰å«åšç´«è‰²
[00:39.84]ç»ˆäºæ…¢æ…¢çš„ç†Ÿæ‚‰äº†
[00:43.14]ä¸–ç•Œåªå‰©ä½ å’Œæˆ‘
[00:46.04]åªæœ‰çº¢è‰²è¡¨è¾¾çš„é€å½»
[00:51.8]æœ‰æ—¶æˆ‘ä¹Ÿä¼šæœ‰è“è‰²çš„å°è„¾æ°”
[00:57.66]åªè¦ä½ èƒ½æ¥å—è¿™ç‚¹å°æƒ…ç»ª
[01:03.32]æˆ‘æ„¿ä¸ºä½ ç©¿ä¸Šæ°¸æ’çš„ç™½è‰²å©šçº±
[01:09.35]çˆ±æƒ…æœ‰ç´«è‰²çº¢è‰²è“è‰²ç™½è‰²å››ç§é¢œè‰²
[01:15.2]ç»˜ç”»å‡ºæ‹çˆ±ä¸­ç»šçƒ‚çš„ä¸–ç•Œ
[01:21.76]ç´«è‰²æ˜¯ç¾å¥½çš„
[01:25.38]çº¢è‰²çƒ­çƒˆ
[01:27.69]è“è‰²ä¸å¯é¿å…
[01:29.76]ç™½è‰²å¯å¦èƒ½é•¿ä¸€äº›
[01:33.119995]çˆ±æƒ…æœ‰ç´«è‰²çº¢è‰²è“è‰²ç™½è‰²å››ç§é¢œè‰²
[01:39.17]æ¯ç§éƒ½ä»£è¡¨æˆ‘å¯¹ä½ çš„æ„Ÿè§‰
[01:45.6]ä¹Ÿè®¸æˆ‘ä»¬æœ‰ä¸ç”Ÿä¿±æ¥çš„å·®åˆ«
[01:51.55]ä½†ä½ çš„ä¸€åˆ‡æˆ‘äº†è§£
[02:06.75]æœ‰æ—¶æˆ‘ä¹Ÿä¼šæœ‰è“è‰²çš„å°è„¾æ°”
[02:12.69]åªè¦ä½ èƒ½æ¥å—è¿™ç‚¹å°æƒ…ç»ª
[02:18.19]æˆ‘æ„¿ä¸ºä½ ç©¿ä¸Šæ°¸æ’çš„ç™½è‰²å©šçº±
[02:24.28]çˆ±æƒ…æœ‰ç´«è‰²çº¢è‰²è“è‰²ç™½è‰²å››ç§é¢œè‰²
[02:30.19]ç»˜ç”»å‡ºæ‹çˆ±ä¸­ç»šçƒ‚çš„ä¸–ç•Œ
[02:37.15]ç´«è‰²æ˜¯ç¾å¥½çš„
[02:40.33]çº¢è‰²çƒ­çƒˆ
[02:42.73]è“è‰²ä¸å¯é¿å…
[02:44.73]ç™½è‰²å¯å¦èƒ½é•¿ä¸€äº›
[02:48.31]çˆ±æƒ…æœ‰ç´«è‰²çº¢è‰²è“è‰²ç™½è‰²å››ç§é¢œè‰²
[02:54.14]æ¯ç§éƒ½ä»£è¡¨æˆ‘å¯¹ä½ çš„æ„Ÿè§‰
[03:00.74]ä¹Ÿè®¸æˆ‘ä»¬æœ‰ä¸ç”Ÿä¿±æ¥çš„å·®åˆ«
[03:06.48]ä½†ä½ çš„ä¸€åˆ‡æˆ‘äº†è§£
[03:12.46]ä½†ä½ çš„ä¸€åˆ‡æˆ‘äº†è§£
`;
        // ==========================================

        // --- 1. LRC è§£æå™¨ (è‡ªåŠ¨æŠŠä¸Šé¢çš„æ–‡å­—è½¬æ¢æˆä»£ç èƒ½è¯»æ‡‚çš„æ—¶é—´) ---
        function parseLrc(lrc) {
            const lines = lrc.split('\n');
            const result = [];
            for (let line of lines) {
                // æ­£åˆ™è¡¨è¾¾å¼åŒ¹é… [00:00.00] æ ¼å¼
                const match = line.match(/\[(\d{2}):(\d{2})(\.\d{2,3})?\](.*)/);
                if (match) {
                    const min = parseInt(match[1]);
                    const sec = parseInt(match[2]);
                    const ms = match[3] ? parseFloat(match[3]) : 0;
                    const text = match[4].trim(); // è·å–æ­Œè¯æ–‡æœ¬
                    
                    // ç®—å‡ºæ€»ç§’æ•°
                    const time = min * 60 + sec + ms;
                    
                    if (text) { // å¦‚æœè¿™è¡Œæœ‰å­—æ‰åŠ è¿›å»
                        result.push({ time, text });
                    }
                }
            }
            return result;
        }

        // è§£ææ­Œè¯
        const lyricData = parseLrc(lrcFileContent);

        // --- 2. æ­Œè¯åŒæ­¥é€»è¾‘ ---
        const lyricDisplay = document.getElementById('lyric-display');
        const audio = document.getElementById('bgm');
        
        audio.addEventListener('timeupdate', function() {
            const currentTime = audio.currentTime;
            
            // æŸ¥æ‰¾å½“å‰æ—¶é—´å¯¹åº”çš„æ­Œè¯
            let currentText = "";
            for (let i = 0; i < lyricData.length; i++) {
                if (currentTime >= lyricData[i].time) {
                    currentText = lyricData[i].text;
                } else {
                    break; 
                }
            }
            
            if (lyricDisplay.innerText !== currentText) {
                // ç®€å•çš„æ·¡å…¥æ·¡å‡ºæ•ˆæœ
                lyricDisplay.style.opacity = 0;
                setTimeout(() => {
                    lyricDisplay.innerText = currentText;
                    lyricDisplay.style.opacity = 1;
                }, 150);
            }
        });

        // --- 3. éŸ³ä¹æ§åˆ¶ä¸ç‰¹æ•ˆ (ä¿æŒä¸å˜) ---
        const musicBtn = document.getElementById('musicBtn');
        let isPlaying = true; 

        window.addEventListener('load', () => {
             audio.play().catch(() => {
                 isPlaying = false;
                 musicBtn.classList.remove('rotate');
             });
        });

        document.body.addEventListener('click', function() {
            if (!isPlaying) {
                audio.play();
                isPlaying = true;
                musicBtn.classList.add('rotate');
            }
        }, { once: true });

        function toggleMusic() {
            if (isPlaying) {
                audio.pause();
                musicBtn.classList.remove('rotate');
            } else {
                audio.play();
                musicBtn.classList.add('rotate');
            }
            isPlaying = !isPlaying;
            event.stopPropagation();
        }

        function bounce(element) {
            element.classList.remove('jelly');
            void element.offsetWidth;
            element.classList.add('jelly');
            const rect = element.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            for(let i=0; i<10; i++) { createHeart(centerX, centerY); }
        }

        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        let width, height;
        let hearts = [];

        function resize() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resize);
        resize();

        class Heart {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.size = Math.random() * 15 + 5;
                this.speedX = Math.random() * 4 - 2;
                this.speedY = Math.random() * -3 - 1;
                this.color = `hsla(${Math.random() * 60 + 330}, 100%, 70%, 1)`;
                this.life = 1;
                this.decay = Math.random() * 0.02 + 0.01;
            }
            update() {
                this.x += this.speedX;
                this.y += this.speedY;
                this.size -= 0.1;
                this.life -= this.decay;
            }
            draw() {
                ctx.fillStyle = this.color;
                ctx.globalAlpha = this.life;
                ctx.beginPath();
                let topCurveHeight = this.size * 0.3;
                ctx.moveTo(this.x, this.y + topCurveHeight);
                ctx.bezierCurveTo(this.x, this.y, this.x - this.size / 2, this.y, this.x - this.size / 2, this.y + topCurveHeight);
                ctx.bezierCurveTo(this.x - this.size / 2, this.y + (this.size + topCurveHeight) / 2, this.x, this.y + (this.size + topCurveHeight) / 2 + topCurveHeight, this.x, this.y + this.size);
                ctx.bezierCurveTo(this.x, this.y + (this.size + topCurveHeight) / 2 + topCurveHeight, this.x + this.size / 2, this.y + (this.size + topCurveHeight) / 2, this.x + this.size / 2, this.y + topCurveHeight);
                ctx.bezierCurveTo(this.x + this.size / 2, this.y, this.x, this.y, this.x, this.y + topCurveHeight);
                ctx.fill();
                ctx.globalAlpha = 1;
            }
        }
        function createHeart(x, y) { hearts.push(new Heart(x, y)); }
        function animate() {
            ctx.clearRect(0, 0, width, height);
            for (let i = 0; i < hearts.length; i++) {
                hearts[i].update();
                hearts[i].draw();
                if (hearts[i].life <= 0 || hearts[i].size <= 0) { hearts.splice(i, 1); i--; }
            }
            requestAnimationFrame(animate);
        }
        animate();
        window.addEventListener('mousemove', (e) => { createHeart(e.clientX, e.clientY); });
        window.addEventListener('touchmove', (e) => {
            e.preventDefault();
            for (let i = 0; i < e.touches.length; i++) { createHeart(e.touches[i].clientX, e.touches[i].clientY); }
        }, { passive: false });
        window.addEventListener('touchstart', (e) => {
            for (let i = 0; i < e.touches.length; i++) {
                createHeart(e.touches[i].clientX, e.touches[i].clientY);
                createHeart(e.touches[i].clientX, e.touches[i].clientY);
            }
        });
        setInterval(() => { createHeart(Math.random() * width, height + 20); }, 500);
    </script>
</body>
</html>
