<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>致阿佳宝宝</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=ZCOOL+KuaiLe&display=swap" rel="stylesheet">

    <style>
        /* --- 1. 基础布局与背景 --- */
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background: linear-gradient(to bottom, #ffdee9 0%, #b5fffc 100%); 
            font-family: 'ZCOOL KuaiLe', cursive;
        }

        /* --- 2. 互动画布 (背景特效) --- */
        #canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            pointer-events: none;
        }

        /* --- 3. 中间文字容器 --- */
        .container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
            text-align: center;
            width: 100%;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        h1 {
            color: #ff5e78;
            font-size: 3.5rem;
            line-height: 1.4;
            margin: 0;
            text-shadow: 2px 2px 0px #fff, 4px 4px 10px rgba(255, 94, 120, 0.3);
            cursor: pointer;
            transition: transform 0.1s;
        }

        h2 {
            color: #ff99ac;
            font-size: 2rem;
            margin-top: 10px;
            font-weight: normal;
        }

        /* --- 4. 音乐图标样式 --- */
        .music-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 999;
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.6);
            border-radius: 50%;
            border: 2px solid #ff5e78;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(255, 94, 120, 0.3);
        }

        /* 音乐播放时的旋转动画 */
        .rotate {
            animation: spin 3s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .music-icon {
            width: 20px;
            height: 20px;
            fill: #ff5e78;
        }

        /* --- 5. 文字Q弹动画 --- */
        .jelly { animation: jelly 0.6s; }
        @keyframes jelly {
            0%, 100% { transform: scale(1, 1); }
            25% { transform: scale(0.9, 1.1); }
            50% { transform: scale(1.1, 0.9); }
            75% { transform: scale(0.95, 1.05); }
        }

        @media (max-width: 768px) {
            h1 { font-size: 2.8rem; }
            h2 { font-size: 1.5rem; }
        }
        
        .hint {
            position: absolute;
            bottom: 20px;
            width: 100%;
            text-align: center;
            color: #aaa;
            font-size: 0.8rem;
            z-index: 5;
            opacity: 0.7;
        }
    </style>
</head>
<body>

    <audio id="bgm" loop>
        <source src="love.mp3" type="audio/mpeg">
    </audio>

    <div class="music-btn rotate" id="musicBtn" onclick="toggleMusic()">
        <svg class="music-icon" viewBox="0 0 24 24">
            <path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"/>
        </svg>
    </div>

    <canvas id="canvas"></canvas>

    <div class="container">
        <h1 id="main-text" onclick="bounce(this)">阿佳宝宝</h1>
        <h2 onclick="bounce(this)">我爱你</h2>
    </div>

    <div class="hint">点击屏幕开启惊喜</div>

    <script>
        // --- 音乐控制逻辑 ---
        const audio = document.getElementById('bgm');
        const musicBtn = document.getElementById('musicBtn');
        let isPlaying = true; // 默认状态我们希望是播放的

        // 尝试自动播放 (大部分浏览器会拦截，所以需要下面的点击触发)
        window.addEventListener('load', () => {
             audio.play().catch(() => {
                 // 如果自动播放被拦截，先停止旋转动画
                 isPlaying = false;
                 musicBtn.classList.remove('rotate');
             });
        });

        // 全局点击触发：用户第一次点击屏幕任何地方，就尝试播放音乐
        document.body.addEventListener('click', function() {
            if (!isPlaying) {
                audio.play();
                isPlaying = true;
                musicBtn.classList.add('rotate');
            }
        }, { once: true }); // 只触发一次

        // 按钮手动控制开关
        function toggleMusic() {
            if (isPlaying) {
                audio.pause();
                musicBtn.classList.remove('rotate');
            } else {
                audio.play();
                musicBtn.classList.add('rotate');
            }
            isPlaying = !isPlaying;
            // 阻止冒泡，防止触发 bounce
            event.stopPropagation();
        }

        // --- 文字与特效逻辑 (保持不变) ---
        function bounce(element) {
            element.classList.remove('jelly');
            void element.offsetWidth;
            element.classList.add('jelly');
            
            const rect = element.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            for(let i=0; i<10; i++) {
                createHeart(centerX, centerY);
            }
        }

        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        let width, height;
        let hearts = [];

        function resize() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resize);
        resize();

        class Heart {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.size = Math.random() * 15 + 5;
                this.speedX = Math.random() * 4 - 2;
                this.speedY = Math.random() * -3 - 1;
                this.color = `hsla(${Math.random() * 60 + 330}, 100%, 70%, 1)`;
                this.life = 1;
                this.decay = Math.random() * 0.02 + 0.01;
            }

            update() {
                this.x += this.speedX;
                this.y += this.speedY;
                this.size -= 0.1;
                this.life -= this.decay;
            }

            draw() {
                ctx.fillStyle = this.color;
                ctx.globalAlpha = this.life;
                ctx.beginPath();
                let topCurveHeight = this.size * 0.3;
                ctx.moveTo(this.x, this.y + topCurveHeight);
                ctx.bezierCurveTo(this.x, this.y, this.x - this.size / 2, this.y, this.x - this.size / 2, this.y + topCurveHeight);
                ctx.bezierCurveTo(this.x - this.size / 2, this.y + (this.size + topCurveHeight) / 2, this.x, this.y + (this.size + topCurveHeight) / 2 + topCurveHeight, this.x, this.y + this.size);
                ctx.bezierCurveTo(this.x, this.y + (this.size + topCurveHeight) / 2 + topCurveHeight, this.x + this.size / 2, this.y + (this.size + topCurveHeight) / 2, this.x + this.size / 2, this.y + topCurveHeight);
                ctx.bezierCurveTo(this.x + this.size / 2, this.y, this.x, this.y, this.x, this.y + topCurveHeight);
                ctx.fill();
                ctx.globalAlpha = 1;
            }
        }

        function createHeart(x, y) {
            hearts.push(new Heart(x, y));
        }

        function animate() {
            ctx.clearRect(0, 0, width, height);
            for (let i = 0; i < hearts.length; i++) {
                hearts[i].update();
                hearts[i].draw();
                if (hearts[i].life <= 0 || hearts[i].size <= 0) {
                    hearts.splice(i, 1);
                    i--;
                }
            }
            requestAnimationFrame(animate);
        }
        animate();

        window.addEventListener('mousemove', (e) => {
            createHeart(e.clientX, e.clientY);
        });

        window.addEventListener('touchmove', (e) => {
            e.preventDefault();
            for (let i = 0; i < e.touches.length; i++) {
                createHeart(e.touches[i].clientX, e.touches[i].clientY);
            }
        }, { passive: false });

        window.addEventListener('touchstart', (e) => {
            for (let i = 0; i < e.touches.length; i++) {
                createHeart(e.touches[i].clientX, e.touches[i].clientY);
                createHeart(e.touches[i].clientX, e.touches[i].clientY);
            }
        });

        setInterval(() => {
            createHeart(Math.random() * width, height + 20);
        }, 500);

    </script>
</body>
</html>